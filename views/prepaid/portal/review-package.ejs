<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title><%= title %> - Portal Prepaid</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
  <style>
    /* Ensure icons and text are visible */
    .fas, .fab, .far {
      display: inline-block !important;
      visibility: visible !important;
      opacity: 1 !important;
    }
    i[class*="fa-"] {
      color: inherit !important;
    }
    label, p, span, h1, h2, h3, h4, h5, h6 {
      color: inherit !important;
    }
  </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen">
  <!-- Header -->
  <div class="bg-white shadow-sm">
    <div class="container mx-auto px-4 py-4 flex justify-between items-center">
      <h1 class="text-2xl font-bold text-indigo-600">
        <i class="fas fa-wifi mr-2"></i>Portal Prepaid
      </h1>
      <a href="/prepaid/portal/packages" class="text-gray-600 hover:text-indigo-600">
        <i class="fas fa-arrow-left mr-1"></i>Kembali
      </a>
    </div>
  </div>

  <!-- Main Content -->
  <div class="container mx-auto px-4 py-8">
    <div class="max-w-2xl mx-auto">
      <!-- Title -->
      <div class="text-center mb-8">
        <h2 class="text-3xl font-bold text-gray-800 mb-2">
          📋 Review Paket
        </h2>
        <p class="text-gray-600">Pastikan detail paket sudah benar sebelum melanjutkan</p>
      </div>

      <!-- Package Card -->
      <div class="bg-white rounded-xl shadow-xl overflow-hidden">
        <!-- Package Header -->
        <div class="bg-gradient-to-r from-indigo-500 to-purple-600 p-8 text-white">
          <h3 class="text-2xl font-bold mb-3"><%= package.name %></h3>
          <div class="flex items-baseline">
            <div class="text-5xl font-extrabold">
              Rp <%= Number(package.price).toLocaleString('id-ID') %>
            </div>
            <div class="text-xl opacity-90 ml-2">/<%= package.duration_days %> hari</div>
          </div>
        </div>

        <!-- Package Details -->
        <div class="p-8">
          <h4 class="text-lg font-semibold text-gray-800 mb-4">Detail Paket:</h4>
          
          <div class="space-y-4">
            <!-- Download Speed -->
            <div class="flex items-center justify-between p-4 bg-green-50 rounded-lg border border-green-200">
              <div class="flex items-center">
                <i class="fas fa-download text-2xl text-green-600 mr-4"></i>
                <div>
                  <div class="text-sm text-gray-600">Download Speed</div>
                  <% if (package.connection_type === 'static' && package.allow_custom_speed) { %>
                    <div class="text-xs text-gray-500 mt-1">Pilih kecepatan Anda (Opsional)</div>
                  <% } else { %>
                    <div class="text-xl font-bold text-gray-900"><%= package.download_mbps %> Mbps</div>
                  <% } %>
                </div>
              </div>
            </div>

            <!-- Upload Speed -->
            <div class="flex items-center justify-between p-4 bg-blue-50 rounded-lg border border-blue-200">
              <div class="flex items-center">
                <i class="fas fa-upload text-2xl text-blue-600 mr-4"></i>
                <div>
                  <div class="text-sm text-gray-600">Upload Speed</div>
                  <% if (package.connection_type === 'static' && package.allow_custom_speed) { %>
                    <div class="text-xs text-gray-500 mt-1">Pilih kecepatan Anda (Opsional)</div>
                  <% } else { %>
                    <div class="text-xl font-bold text-gray-900"><%= package.upload_mbps %> Mbps</div>
                  <% } %>
                </div>
              </div>
            </div>

            <!-- Duration -->
            <div class="flex items-center justify-between p-4 bg-purple-50 rounded-lg border border-purple-200">
              <div class="flex items-center">
                <i class="fas fa-calendar text-2xl text-purple-600 mr-4"></i>
                <div>
                  <div class="text-sm text-gray-600">Masa Aktif</div>
                  <div class="text-xl font-bold text-gray-900"><%= package.duration_days %> Hari</div>
                </div>
              </div>
            </div>

            <!-- Quota -->
            <div class="flex items-center justify-between p-4 bg-yellow-50 rounded-lg border border-yellow-200">
              <div class="flex items-center">
                <i class="fas fa-infinity text-2xl text-yellow-600 mr-4"></i>
                <div>
                  <div class="text-sm text-gray-600">Kuota Internet</div>
                  <div class="text-xl font-bold text-gray-900">Unlimited</div>
                </div>
              </div>
            </div>
          </div>

          <!-- Description -->
          <% if (package.description) { %>
            <div class="mt-6 p-4 bg-gray-50 rounded-lg">
              <p class="text-gray-700"><%= package.description %></p>
            </div>
          <% } %>

          <!-- Custom Speed Input for Static IP -->
          <% if (package.connection_type === 'static' && package.allow_custom_speed) { %>
            <div class="mt-6 p-6 bg-blue-50 rounded-lg border-2 border-blue-300">
              <h4 class="text-lg font-semibold text-blue-800 mb-4">
                <i class="fas fa-sliders-h mr-2"></i>Pilih Kecepatan Internet
              </h4>
              <p class="text-sm text-blue-700 mb-4">
                Untuk paket Static IP, Anda dapat memilih kecepatan download dan upload sesuai kebutuhan.
                Jika tidak diisi, akan menggunakan kecepatan default paket.
              </p>
              
              <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <!-- Download Speed Input -->
                <div>
                  <label for="custom_download_mbps" class="block text-sm font-medium text-gray-700 mb-2">
                    <i class="fas fa-download text-green-600 mr-1"></i>Download (Mbps)
                  </label>
                  <input type="number" 
                         id="custom_download_mbps" 
                         name="custom_download_mbps" 
                         min="1" 
                         step="0.1"
                         value="<%= package.download_mbps %>"
                         placeholder="<%= package.download_mbps %>"
                         class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                  <p class="text-xs text-gray-500 mt-1">Default: <%= package.download_mbps %> Mbps</p>
                </div>

                <!-- Upload Speed Input -->
                <div>
                  <label for="custom_upload_mbps" class="block text-sm font-medium text-gray-700 mb-2">
                    <i class="fas fa-upload text-blue-600 mr-1"></i>Upload (Mbps)
                  </label>
                  <input type="number" 
                         id="custom_upload_mbps" 
                         name="custom_upload_mbps" 
                         min="1" 
                         step="0.1"
                         value="<%= package.upload_mbps %>"
                         placeholder="<%= package.upload_mbps %>"
                         class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                  <p class="text-xs text-gray-500 mt-1">Default: <%= package.upload_mbps %> Mbps</p>
                </div>
              </div>
            </div>
          <% } %>

          <!-- Payment Form -->
          <form action="/prepaid/portal/payment/select-method" method="POST" class="mt-8">
            <input type="hidden" name="package_id" value="<%= package.id %>">
            <% if (package.connection_type === 'static' && package.allow_custom_speed) { %>
              <input type="hidden" id="hidden_custom_download" name="custom_download_mbps" value="">
              <input type="hidden" id="hidden_custom_upload" name="custom_upload_mbps" value="">
            <% } %>
            
            <!-- Total -->
            <div class="border-t border-b py-4 mb-6">
              <div class="flex items-center justify-between">
                <span class="text-lg font-semibold text-gray-700">Total Pembayaran:</span>
                <span class="text-3xl font-bold text-indigo-600">
                  Rp <%= Number(package.price).toLocaleString('id-ID') %>
                </span>
              </div>
            </div>

            <!-- Terms -->
            <div class="mb-6">
              <label class="flex items-start">
                <input type="checkbox" required class="mt-1 mr-3 rounded text-indigo-600 focus:ring-2 focus:ring-indigo-500">
                <span class="text-sm text-gray-600">
                  Saya setuju dengan syarat dan ketentuan yang berlaku. Paket akan aktif setelah pembayaran diverifikasi oleh admin.
                </span>
              </label>
            </div>

            <!-- Buttons -->
            <div class="flex space-x-4">
              <a href="/prepaid/portal/packages" 
                 class="flex-1 text-center px-6 py-3 border border-gray-300 rounded-lg text-gray-700 font-semibold hover:bg-gray-50">
                <i class="fas fa-arrow-left mr-2"></i>Kembali
              </a>
              <button type="submit" 
                      class="flex-1 px-6 py-3 bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white font-bold rounded-lg">
                <i class="fas fa-arrow-right mr-2"></i>Lanjut ke Pembayaran
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <div class="container mx-auto px-4 py-8 text-center text-gray-600 text-sm">
    <p>&copy; 2025 Billing System. All rights reserved.</p>
  </div>

  <!-- JavaScript for custom speed form handling -->
  <% if (package.connection_type === 'static' && package.allow_custom_speed) { %>
  <script>
    document.querySelector('form').addEventListener('submit', function(e) {
      const downloadInput = document.getElementById('custom_download_mbps');
      const uploadInput = document.getElementById('custom_upload_mbps');
      const hiddenDownload = document.getElementById('hidden_custom_download');
      const hiddenUpload = document.getElementById('hidden_custom_upload');
      
      // Copy values to hidden inputs (in case of form submission issues)
      if (downloadInput.value) {
        hiddenDownload.value = downloadInput.value;
      }
      if (uploadInput.value) {
        hiddenUpload.value = uploadInput.value;
      }
    });
  </script>
  <% } %>
</body>
</html>

