<div class="container-fluid px-4 py-6">
    <div class="mb-6">
        <h1 class="text-3xl font-bold text-gray-800 mb-2">
            <i class="fas fa-chart-bar text-indigo-600 mr-3"></i>
            Laporan Prepaid
        </h1>
        <p class="text-gray-600">Statistik dan laporan revenue sistem prepaid</p>
    </div>

    <!-- Monthly Revenue -->
    <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
        <h3 class="text-lg font-bold text-gray-800 mb-4">
            <i class="fas fa-calendar-alt text-blue-600 mr-2"></i>
            Revenue Bulanan (12 Bulan Terakhir)
        </h3>
        <% if (monthlyRevenue && monthlyRevenue.length > 0) { %>
        <div class="overflow-x-auto">
            <table class="w-full">
                <thead>
                    <tr class="border-b border-gray-200">
                        <th class="text-left py-3 px-4 text-sm font-semibold text-gray-600">Bulan</th>
                        <th class="text-right py-3 px-4 text-sm font-semibold text-gray-600">Transaksi</th>
                        <th class="text-right py-3 px-4 text-sm font-semibold text-gray-600">Revenue</th>
                    </tr>
                </thead>
                <tbody>
                    <% monthlyRevenue.forEach(function(item) { %>
                    <tr class="border-b border-gray-100 hover:bg-gray-50">
                        <td class="py-3 px-4 font-semibold"><%= item.month %></td>
                        <td class="py-3 px-4 text-right"><%= item.transactions %></td>
                        <td class="py-3 px-4 text-right font-semibold text-green-600">
                            Rp <%= item.revenue.toLocaleString('id-ID') %>
                        </td>
                    </tr>
                    <% }); %>
                </tbody>
            </table>
        </div>
        <% } else { %>
        <p class="text-center py-8 text-gray-500">Belum ada data revenue</p>
        <% } %>
    </div>

    <!-- Package Popularity -->
    <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
        <h3 class="text-lg font-bold text-gray-800 mb-4">
            <i class="fas fa-fire text-orange-600 mr-2"></i>
            Paket Terpopuler
        </h3>
        <% if (packagePopularity && packagePopularity.length > 0) { %>
        <div class="space-y-4">
            <% packagePopularity.forEach(function(item, index) { %>
            <div class="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
                <div class="flex items-center">
                    <div class="w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center text-white font-bold mr-3">
                        <%= index + 1 %>
                    </div>
                    <div>
                        <div class="font-semibold text-gray-800"><%= item.name %></div>
                        <div class="text-sm text-gray-600"><%= item.purchases %> pembelian</div>
                    </div>
                </div>
                <div class="text-right">
                    <div class="font-bold text-green-600">Rp <%= item.revenue.toLocaleString('id-ID') %></div>
                    <div class="text-xs text-gray-500">Total revenue</div>
                </div>
            </div>
            <% }); %>
        </div>
        <% } else { %>
        <p class="text-center py-8 text-gray-500">Belum ada data paket</p>
        <% } %>
    </div>

    <!-- Revenue by Day (30 days) -->
    <div class="bg-white rounded-xl shadow-lg p-6">
        <h3 class="text-lg font-bold text-gray-800 mb-4">
            <i class="fas fa-chart-line text-green-600 mr-2"></i>
            Revenue Harian (30 Hari Terakhir)
        </h3>
        <% if (revenueByDay && revenueByDay.length > 0) { %>
        <div class="overflow-x-auto">
            <table class="w-full">
                <thead>
                    <tr class="border-b border-gray-200">
                        <th class="text-left py-3 px-4 text-sm font-semibold text-gray-600">Tanggal</th>
                        <th class="text-right py-3 px-4 text-sm font-semibold text-gray-600">Transaksi</th>
                        <th class="text-right py-3 px-4 text-sm font-semibold text-gray-600">Revenue</th>
                    </tr>
                </thead>
                <tbody>
                    <% revenueByDay.forEach(function(item) { %>
                    <tr class="border-b border-gray-100 hover:bg-gray-50">
                        <td class="py-3 px-4"><%= new Date(item.date).toLocaleDateString('id-ID') %></td>
                        <td class="py-3 px-4 text-right"><%= item.transactions %></td>
                        <td class="py-3 px-4 text-right font-semibold text-green-600">
                            Rp <%= item.revenue.toLocaleString('id-ID') %>
                        </td>
                    </tr>
                    <% }); %>
                </tbody>
            </table>
        </div>
        <% } else { %>
        <p class="text-center py-8 text-gray-500">Belum ada data revenue harian</p>
        <% } %>
    </div>
</div>

<%- include('../../partials/footer') %>

