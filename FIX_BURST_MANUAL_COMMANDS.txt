====================================================================
🔧 FIX BURST LIMITING - MANUAL COMMANDS (COPY-PASTE SATU PER SATU)
====================================================================

PENTING: Jalankan perintah INI SATU PER SATU, jangan langsung semua!
Tunggu sampai setiap perintah selesai sebelum lanjut ke perintah berikutnya.

====================================================================
COMMAND 1: Masuk ke direktori project
====================================================================

cd /opt/billing

✅ Seharusnya muncul: (tidak ada output, prompt berubah)
❌ Jika error: "no such file or directory" → cek lokasi project


====================================================================
COMMAND 2: Pull code terbaru
====================================================================

git pull origin main

✅ Seharusnya muncul:
   Already up to date.
   atau
   Updating xxxxx..yyyyy
   Fast-forward
   ...

❌ Jika error: "fatal: not a git repository"
   → Cek apakah di direktori yang benar


====================================================================
COMMAND 3: Install dependencies (PENTING!)
====================================================================

npm install

✅ Seharusnya muncul:
   added 123 packages, removed 4 packages...
   atau
   up to date, audited 456 packages...
   
   Tunggu sampai muncul prompt lagi (bisa 1-2 menit)

❌ Jika error: "npm: command not found"
   → Install Node.js dulu:
   curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -
   sudo apt-get install -y nodejs
   
❌ Jika error: "EACCES: permission denied"
   → Jalankan:
   sudo chown -R $USER:$USER /opt/billing
   npm install


====================================================================
COMMAND 4: Build project
====================================================================

npm run build

✅ Seharusnya muncul:
   > billing@2.0.8.5 build
   > tsc
   
   (Mungkin ada banyak error TS2xxx, ABAIKAN SAJA)
   
   Tunggu sampai muncul prompt lagi

❌ Jika error: "tsc: not found"
   → Berarti npm install belum berhasil
   → Ulangi COMMAND 3

⚠️  PENTING: Meskipun ada TypeScript errors, build TETAP JALAN!
   JavaScript files tetap di-generate di folder dist/


====================================================================
COMMAND 5: Cek hasil build
====================================================================

ls -lah dist/services/mikrotikService.js dist/services/pppoeService.js

✅ Seharusnya muncul:
   -rw-r--r-- 1 root root 35K Oct 30 12:34 dist/services/mikrotikService.js
   -rw-r--r-- 1 root root 28K Oct 30 12:34 dist/services/pppoeService.js
   
   Cek tanggalnya HARUS hari ini jam yang baru saja!

❌ Jika: "No such file or directory"
   → Build gagal, ulangi COMMAND 4


====================================================================
COMMAND 6: Cek PM2 process
====================================================================

pm2 list

✅ Seharusnya muncul tabel seperti:
   ┌─────┬──────────────┬─────────┬─────────┬──────────┐
   │ id  │ name         │ status  │ cpu     │ memory   │
   ├─────┼──────────────┼─────────┼─────────┼──────────┤
   │ 0   │ billing-app  │ online  │ 0%      │ 123.4mb  │
   └─────┴──────────────┴─────────┴─────────┴──────────┘

Catat NAMA process (billing-app / billing-system / billing)

❌ Jika kosong atau process tidak ada:
   → Lanjut ke COMMAND 7b (start baru)


====================================================================
COMMAND 7a: Restart PM2 (jika process sudah ada)
====================================================================

Ganti "billing-app" dengan nama process dari COMMAND 6:

pm2 restart billing-app

✅ Seharusnya muncul:
   [PM2] Restarting billing-app
   [PM2] Done


====================================================================
COMMAND 7b: Start PM2 (jika process belum ada)
====================================================================

pm2 start ecosystem.config.js --env production
pm2 save

✅ Seharusnya muncul:
   [PM2] Starting process...
   [PM2] Done


====================================================================
COMMAND 8: Cek PM2 status
====================================================================

pm2 status

✅ Status HARUS "online" dan warna hijau


====================================================================
COMMAND 9: Monitor log (PENTING - BIARKAN TERBUKA!)
====================================================================

pm2 logs billing-app --lines 0

Ganti "billing-app" dengan nama process Anda.

⚠️  JANGAN TUTUP TERMINAL INI!
   Biarkan tetap terbuka untuk monitoring.


====================================================================
LANGKAH SELANJUTNYA: TEST DI BROWSER
====================================================================

1. Buka browser
2. Login ke sistem billing
3. Buka URL: http://your-domain/packages/pppoe/profiles
4. Klik tombol: "🔄 Sync dari MikroTik"
5. Tunggu notifikasi "Berhasil sync X profil"


====================================================================
CEK LOG (KEMBALI KE TERMINAL YANG MONITORING)
====================================================================

Di terminal yang menjalankan pm2 logs, cari output seperti ini:

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
🔍 Processing profile: Paket-110k

📊 FINAL BURST DATA for Paket-110k: {
  'burst_limit_rx': '50M',          <-- CEK INI
  'burst_limit_tx': '50M',          <-- CEK INI
  'burst_threshold_rx': '15M',      <-- CEK INI
  'burst_threshold_tx': '15M',      <-- CEK INI
  'burst_time_rx': '10s',           <-- CEK INI
  'burst_time_tx': '10s'            <-- CEK INI
}
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

✅ Jika semua field TERISI (bukan 'EMPTY'):
   → SUKSES! Refresh browser untuk lihat data

❌ Jika semua field 'EMPTY':
   → MikroTik tidak punya burst setting untuk profile ini
   → Harus set manual di MikroTik


====================================================================
VERIFIKASI AKHIR DI BROWSER
====================================================================

1. Refresh halaman /packages/pppoe/profiles
2. Cek kolom:
   - Burst RX
   - Threshold RX  
   - Time RX
   - Burst TX
   - Threshold TX
   - Time TX

3. Jika data muncul (bukan dash): ✅ SUKSES!
4. Jika masih dash: Kirim screenshot log PM2


====================================================================
JIKA MASIH GAGAL - INFO YANG PERLU DIKIRIM:
====================================================================

1. Screenshot output COMMAND 4 (npm run build)
2. Screenshot output COMMAND 6 (pm2 list)
3. Screenshot log PM2 untuk 1 profile (dari "Processing profile" sampai "FINAL BURST DATA")
4. Screenshot halaman /packages/pppoe/profiles di browser
5. Info versi RouterOS MikroTik


====================================================================
QUICK TROUBLESHOOTING:
====================================================================

Problem: "tsc: not found" saat npm run build
Fix: npm install

Problem: Build error "Cannot find module..."
Fix: rm -rf node_modules && npm install

Problem: PM2 process tidak start
Fix: pm2 delete all && pm2 start ecosystem.config.js --env production

Problem: Burst data EMPTY di log
Fix: Set burst di MikroTik dulu, baru sync lagi

Problem: Data di log OK tapi browser kosong
Fix: Hard refresh browser (Ctrl+Shift+R)


====================================================================

